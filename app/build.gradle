apply plugin: 'com.android.application'

// The possible values are: armeabi, armeabi-v7a, arm64-v8a, x86, x86_64, mips, mips64
String abi = 'armeabi-v7a'

android {
    compileSdkVersion 27
    defaultConfig {
        applicationId "osebuild.app.oscam"
        minSdkVersion 16
        targetSdkVersion 27
        versionCode 1
        versionName "1.0"
        ndk {
            abiFilters abi
        }
    }
    externalNativeBuild {
        ndkBuild {
            path 'src/main/jni/Android.mk'
        }
    }
    buildTypes {
        release {
            minifyEnabled false
            proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro'
        }
    }
    compileOptions {
        targetCompatibility 1.8
        sourceCompatibility 1.8
    }
}

dependencies {}

gradle.taskGraph.afterTask { task ->
    String string
    if (task.name == "externalNativeBuildRelease") string = 'release'
    else string = 'debug'
    def src = 'build/intermediates/ndkBuild/' + string + '/obj/local/' + abi
    copy {
        from(src) { exclude "/objs*" exclude "/libusb1.0*" }
        into 'src/main/assets/'
    }
}